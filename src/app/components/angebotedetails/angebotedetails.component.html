<ion-header translucent>
    <ion-toolbar>
        <ion-buttons slot="end">
            <ion-button (click)="dismiss()">Schließen</ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>
<ion-content>
    <ion-list class="ion-margin-horizontal">
        <h2 class="ion-text-center">Transportangebot erstellen</h2>
        <ion-row>
            <ion-segment mode="ios" (ionChange)="segmentChanged($event)" [(ngModel)]="tabSwitch">
                <ion-segment-button value="start">
                    <ion-label>Start</ion-label>
                </ion-segment-button>
                <ion-segment-button value="ziel">
                    <ion-label>Ziel</ion-label>
                </ion-segment-button>
            </ion-segment>
        </ion-row>
        <div [ngSwitch]="tabSwitch">
            <!---------------------------------------------->
            <!------------------ Ziel Tab ------------------>
            <!---------------------------------------------->
            <div *ngSwitchCase="'ziel'">
                <ion-row>
                    <ion-col>
                        <ion-item lines="none">
                            <ion-item lines="none">
                                <ion-label class="label-margin" position="floating">Ankunftsdatum und -uhrzeit</ion-label>
                                <ion-datetime displayFormat="DD/MM/YYYY +HH:mm" [min]="now" [max]="now + 2"
                                              placeholder="Ankunftsdatum wählen" [(ngModel)]="endDate"></ion-datetime>
                            </ion-item>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('ankunftDatum')">
                                {{errors.get('ankunftDatum')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col size="9">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">Straße</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="angebot.ankunftStrasse" type="text"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('ankunftStrasse')">
                                {{errors.get('ankunftStrasse')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                    <ion-col size="3">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">Nr.</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="ankunftNummer" type="number"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('ankunftNummer')">
                                {{errors.get('ankunftNummer')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col size="4">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">PLZ</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="angebot.ankunftPlz" type="number"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('ankunftPlz')">
                                {{errors.get('ankunftPlz')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                    <ion-col size="8">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">Ort</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="angebot.ankunftOrt" type="text"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('ankunftOrt')">
                                {{errors.get('ankunftOrt')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                </ion-row>
            </div>
            <!---------------------------------------------->
            <!----------------- Start Tab ------------------>
            <!---------------------------------------------->
            <div *ngSwitchCase="'start'">
                <ion-row>
                    <ion-col size="9">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">Abfahrtstraße</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="angebot.abfahrtStrasse" type="text"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('abfahrtStrasse')">
                                {{errors.get('abfahrtStrasse')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                    <ion-col size="3">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">Nr.</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="abfahrtNummer" type="number"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('abfahrtNummer')">
                                {{errors.get('abfahrtNummer')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col size="4">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">PLZ</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="angebot.abfahrtPlz" type="number"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('abfahrtPlz')">
                                {{errors.get('abfahrtPlz')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                    <ion-col size="8">
                        <ion-item lines="none">
                            <ion-label class="label-margin" position="stacked">Abfahrtsort</ion-label>
                            <ion-input [autofocus]="true" [readonly]="detailmode"
                                       [(ngModel)]="angebot.abfahrtOrt" type="text"></ion-input>
                            <ion-text class="ion-text-end ion-padding-end"
                                      style="color:var(--ion-color-danger)"
                                      *ngIf="errors.get('abfahrtOrt')">
                                {{errors.get('abfahrtOrt')}}
                            </ion-text>
                        </ion-item>
                    </ion-col>
                </ion-row>
            </div>
        </div>

        <div *ngIf="!this.angebot.fahrzeugId">
            <ion-row>
                <ion-col class="vertical-center">
                    <h3 class="ion-margin-start">Fahrzeug auswählen</h3>
                </ion-col>
                <ion-col class="vertical-center">
                    <ion-button size="small" class="small-add" (click)="this.openFahrzeugModal(angebot)">
                        <ion-icon name="add" slot="icon-only"></ion-icon>
                    </ion-button>
                </ion-col>
            </ion-row>
        </div>
        <!-- Todo: Add a new Fahrzeug if there is no in the user -->
        <div *ngIf="this.angebot.fahrzeugId && angebotFahrzeug" class="selected-fahrzeug">
            <ion-row>
                <ion-col class="vertical-center">
                    <h3 class="ion-margin-start">Fahrzeug auswählen</h3>
                </ion-col>
                <ion-col class="vertical-center">
                    <ion-button size="small" class="small-del" color="danger" (click)="this.angebot.deleteFahrzeug()">
                        <ion-icon name="trash" slot="icon-only"></ion-icon>
                    </ion-button>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col>
                    <ion-label class="label-margin">
                        Marke
                    </ion-label>
                    <ion-item lines="none">
                        <p>{{angebotFahrzeug.marke}}</p>
                    </ion-item>
                </ion-col>
                <ion-col>
                    <ion-label class="label-margin">
                        Modell
                    </ion-label>
                    <ion-item lines="none">
                        <p>{{angebotFahrzeug.modell}}</p>
                    </ion-item>
                </ion-col>
                <ion-col>
                    <ion-label class="label-margin">
                        Fahrzeugart
                    </ion-label>
                    <ion-item lines="none">
                        <p>{{angebotFahrzeug.fahrzeugart}}</p>
                    </ion-item>
                </ion-col>
            </ion-row>
            <h3>Ladefläche</h3>
            <ion-row>
                <ion-col>
                    <ion-label class="label-margin">
                        Höhe
                    </ion-label>
                    <ion-item lines="none">
                        <p>{{angebotFahrzeug.hoehe}}</p>
                    </ion-item>
                </ion-col>
                <ion-col>
                    <ion-label class="label-margin">
                        Breite
                    </ion-label>
                    <ion-item lines="none">
                        <p>{{angebotFahrzeug.breite}}</p>
                    </ion-item>
                </ion-col>
                <ion-col>
                    <ion-label class="label-margin">
                        Tiefe
                    </ion-label>
                    <ion-item lines="none">
                        <p>{{angebotFahrzeug.tiefe}}</p>
                    </ion-item>
                </ion-col>
            </ion-row>
        </div>
        <ion-button *ngIf="!detailmode" expand="block" class="bg-green ion-margin-top" (click)="save()">
            Speichern
        </ion-button>
        <ion-button *ngIf="detailmode" expand="block" class="bg-green ion-margin-top" (click)="dismiss()">
            Zurück
        </ion-button>
    </ion-list>
</ion-content>
